fs = 31.12e6/2;
conversion_factor = 1e-6;
end_time = 2.5 * conversion_factor;

total_samples = round(fs * end_time); 
query_points = 1:total_samples;

%Lookup Table from image: https://apps.automeris.io/wpd/
% Replace , with .
coords = [0.03649 -0.00812
        0.05087 -0.00918
        0.07604 -0.00812
        0.09281 -0.00918
        0.10658 -0.00970
        0.12995 -0.00875
        0.14793 -0.00875
        0.16590 -0.00875
        0.18388 -0.00812
        0.20185 -0.00812
        0.21982 -0.00812
        0.23779 -0.00939
        0.25577 -0.00812
        0.27374 -0.00812
        0.29172 -0.00812
        0.30969 -0.00812
        0.32766 -0.00812
        0.34563 -0.00875
        0.36361 -0.00875
        0.38157 -0.01002
        0.39956 -0.00812
        0.41752 -0.00939
        0.43459 -0.01050
        0.45348 -0.00812
        0.47264 -0.00918
        0.48942 -0.00939
        0.51818 -0.00875
        0.53971 -0.01572
        0.55767 -0.01888
        0.58638 -0.03155
        0.60433 -0.03598
        0.62227 -0.04484
        0.64022 -0.05117
        0.65479 -0.00496
        0.65106 -0.03661
        0.66577 0.04253
        0.67142 0.10267
        0.66950 0.07418
        0.67708 0.16571
        0.67335 0.13432
        0.68282 0.24828
        0.68086 0.21029
        0.68659 0.28943
        0.69098 0.33480
        0.70315 0.37933
        0.71558 0.34324
        0.71371 0.32742
        0.71718 0.29734
        0.71707 0.27044
        0.72051 0.23456
        0.72153 0.19341
        0.72381 0.16598
        0.72478 0.11217
        0.72706 0.08368
        0.72867 0.04094
        0.72680 0.02353
        0.73195 -0.03503
        0.73170 -0.09359
        0.73663 -0.20121
        0.73650 -0.23287
        0.73752 -0.27613
        0.74133 -0.36582
        0.74061 -0.39536
        0.74185 -0.45524
        0.74444 -0.48030
        0.74367 -0.52092
        0.74594 -0.54941
        0.74582 -0.57790
        0.74684 -0.62116
        0.74914 -0.64438
        0.74900 -0.67603
        0.75065 -0.71085
        0.74989 -0.74989
        0.75454 -0.78366
        0.75378 -0.82164
        0.76258 -0.86437
        0.76326 -0.91740
        0.77846 -0.68110
        0.77658 -0.74330
        0.77609 -0.78788
        0.77973 -0.63567
        0.78416 -0.43862
        0.78459 -0.47766
        0.78210 -0.49877
        0.78197 -0.53042
        0.78184 -0.56207
        0.78170 -0.59373
        0.79094 -0.10942
        0.78896 -0.15373
        0.78882 -0.18539
        0.78869 -0.21704
        0.78856 -0.24870
        0.78843 -0.27877
        0.78827 -0.31517
        0.78814 -0.34682
        0.78738 -0.38586
        0.79393 0.03092
        0.79256 -0.00970
        0.79353 -0.06404
        0.79979 0.28120
        0.79765 0.20080
        0.79753 0.17231
        0.79560 0.14065
        0.79546 0.10900
        0.79533 0.07735
        0.80221 0.42871
        0.80208 0.39706
        0.80195 0.36698
        0.80441 0.52367
        0.80355 0.32108
        0.80899 0.75686
        0.80885 0.72310
        0.80868 0.68195
        0.80835 0.60597
        0.81489 0.87504
        0.81476 0.84497
        0.81275 0.79590
        0.82681 0.96186
        0.83302 0.91302
        0.83468 0.88137
        0.83456 0.85288
        0.83617 0.80698
        0.83939 0.72072
        0.84441 0.63235
        0.84428 0.60123
        0.84415 0.57115
        0.84579 0.53317
        0.84568 0.50626
        0.84547 0.45720
        0.84950 0.41921
        0.84873 0.37806
        0.84797 0.34113
        0.85199 0.29893
        0.85357 0.24828
        0.85343 0.21663
        0.85330 0.18497
        0.85494 0.14699
        0.85483 0.12166
        0.85640 0.06785
        0.85798 0.01720
        0.85785 -0.01445
        0.85771 -0.04611
        0.85696 -0.08304
        0.85924 -0.11100
        0.86027 -0.15057
        0.86256 -0.17589
        0.86417 -0.21810
        0.86404 -0.24870
        0.86391 -0.28035
        0.86557 -0.31236
        0.86723 -0.34524
        0.87058 -0.40380
        0.87036 -0.45445
        0.87198 -0.49560
        0.87539 -0.53992
        0.88514 -0.57236
        0.89534 -0.49718
        0.89338 -0.53675
        0.90176 -0.42596
        0.89729 -0.46078
        0.90303 -0.38006
        0.90759 -0.29407
        0.90497 -0.34682
        0.90899 -0.24553
        0.91530 -0.16956
        0.91395 -0.20649
        0.92031 -0.11891
        0.92788 -0.03028
        0.93528 0.02142
        0.94858 0.04780
        0.96602 0.06389
        0.97694 0.09634
        0.98428 0.13116
        0.99163 0.16914
        1.00344 0.20080
        1.01155 0.20555
        1.02044 0.18181
        1.02682 0.13221
        1.03261 0.08526
        1.03612 0.06468
        1.03955 0.02512
        1.04118 -0.01287
        1.04637 -0.06193
        1.05162 -0.09359
        1.05859 -0.14582
        1.07105 -0.17462
        1.08730 -0.15690
        1.10003 -0.12313
        1.11275 -0.08963
        1.12725 -0.06035
        1.14178 -0.02553
        1.15632 0.01404
        1.16905 0.04886
        1.18181 0.08922
        1.19804 0.10330
        1.21234 0.08473
        1.22296 0.04569
        1.23355 -0.00074
        1.24420 -0.03239
        1.25750 -0.07380
        1.27633 -0.08409
        1.29436 -0.06953
        1.31245 -0.04231
        1.33055 -0.01255
        1.34867 0.02037
        1.36311 0.03619
        1.38468 0.03619
        1.40259 0.02163
        1.42046 -0.00369
        1.43833 -0.02711
        1.45624 -0.04294
        1.47420 -0.04611
        1.49218 -0.04357
        1.51021 -0.03028
        1.52825 -0.01382
        1.54629 0.00137
        1.56250 0.01008
        1.59305 0.00707
        1.61097 -0.00432
        1.62890 -0.01445
        1.64685 -0.02078
        1.66480 -0.02648
        1.70796 -0.02015
        1.72596 -0.01366
        1.74396 -0.00812
        1.76195 -0.00369
        1.78112 -0.00390
        1.79667 -0.00918
        1.81584 -0.01002
        1.83379 -0.01698
        1.85175 -0.02015
        1.86972 -0.01952
        1.88770 -0.01762
        1.90568 -0.01762
        1.92367 -0.01319
        1.94884 -0.01129
        1.96683 -0.00812
        1.98479 -0.01129
        1.99916 -0.01129
        2.02789 -0.01762
        2.04587 -0.01762
        2.06384 -0.01762
        2.07822 -0.01762
        2.10159 -0.01762
        2.12856 -0.01445
        2.14655 -0.01050
        2.16453 -0.00939
        2.18609 -0.01002
        2.20226 -0.01208
        2.23639 -0.01762
        2.25436 -0.01762
        2.27233 -0.01762
        2.28491 -0.01762
        2.30648 -0.01762
        2.33344 -0.01762
        2.34782 -0.01762
        2.37301 -0.01129
        2.38559 -0.01129
        2.40713 -0.01762
        2.42690 -0.01762
        2.44488 -0.01762
        2.47006 -0.01129];

coords(:, 1) = round(coords(:, 1) * conversion_factor * fs); 
coords(end+1, :) = [round(end_time * fs) 0];
[~, uidx] = unique(coords(:, 1));
coords_filtered = coords(uidx, :);

EIR = interp1(coords_filtered(:, 1), coords_filtered(:, 2), query_points)';
%EIR(end+1) = 0;
plot(EIR)